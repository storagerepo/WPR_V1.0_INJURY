
<link rel="stylesheet"
	href="resources/components/datetime/datetimepicker.css"></link>
<script src="resources/components/datetime/moment.js"></script>
<script src="resources/components/datetime/datetimepicker.js"></script>
<div ng-cloak>
<div class="row">
	<div class="col-lg-12">	
		<a ng-show="{{isAdmin==4}}" ui-sref="dashboard.CallerSearchPatients"
			class="btn-sm btn-primary pull-right margin-top-40 btn-margin-left"><i class="fa fa-arrow-circle-left fa-lg"></i> Back
			to Patient</a>
			<a ng-show="{{isAdmin==2}}" ui-sref="dashboard.callerAdminSearchPatients"
			class="btn-sm btn-primary pull-right margin-top-40 btn-margin-left"><i class="fa fa-arrow-circle-left fa-lg"></i> Back
			to Patient</a>
			<a ng-click="addModel()" href=""
			class="btn-sm btn-primary pull-right margin-top-40 margin-left-5 btn-margin-left"><i class="fa fa-plus-circle fa-lg"></i> Add
				Call Logs</a>
		<div flash-message="2000" class="col-md-5 pull-right margin-top35"></div> 
		<h2 class="page-header">
			Call Logs<br>
		</h2>
		<h4>
			Patient Name:<span ng-cloak>{{patient.name}}</span> |
			PhoneNumber&nbsp;-&nbsp;<span ng-cloak>{{patient.phoneNumber}}</span>
			| <a ng-click="viewPatients(patient.id)"
				class="btn btn-xs btn-primary"><i
				class="glyphicon glyphicon-eye-open"></i>&nbsp; View More Details</a> |
			<a href="#/dashboard/viewlocations/{{patient.patientId}}"
				class="btn btn-xs btn-warning"><i
				class="glyphicon glyphicon-map-marker"></i>&nbsp; View Near By
				Clinics</a>
		</h4>
	</div>
	<!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row" ng-cloak>
	<div class="col-lg-12">
		<!-- /.panel-heading -->
		<div class="col-md-12">
		
		
		
			<table class="table table-striped table-bordered">
				<thead>

					<tr>
						<th ng-mousedown="sort('timeStamp')" class="col-md-2">Date and Time&nbsp&nbsp<span
							class="glyphicon sort-icon" ng-show="sortKey=='timeStamp'"
							ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
						<th class="col-md-2">Response</th>
						<th class="col-md-3">Notes</th>
						<th class="col-md-2">Caller Name</th>
						<th class="col-md-2">Actions</th>
					</tr>
					<tr>
					<th>
						<div class="input-group">
							<span class="input-group-addon search" id="basic-addon1"><i class="fa fa-search"></i></span>
							<input class="form-control" type="text" ng-model="search.timeStamp" placeholder="Date Time">
						</div>
					</th>
					<th>
						<div class="input-group">
							<span class="input-group-addon search" id="basic-addon1"><i class="fa fa-search"></i></span>
							<input class="form-control" type="text" ng-model="search.response" placeholder="Response">
						</div>
					</th>
					<th>
						<div class="input-group">
							<span class="input-group-addon search" id="basic-addon1"><i class="fa fa-search"></i></span>
							<input class="form-control" type="text" ng-model="search.notes" placeholder="Notes">
						</div>
					</th>
					<th>
						<div class="input-group">
							<span class="input-group-addon search" id="basic-addon1"><i class="fa fa-search"></i></span>
							<input class="form-control" type="text" ng-model="search.callerName" placeholder="Caller Name">
						</div>
					</th>
					<th></th>
					</tr>
				</thead>
				<tbody ng-show="callLogs.length>0">
					<tr dir-paginate=" callLog in callLogs|filter:search|orderBy:sortKey:reverse|itemsPerPage:20">
						<td ng-cloak>{{callLog.timeStamp}}</td>

						<td ng-cloak>{{callLog.response}}</td>
						<td ng-cloak class="col-md-3 wrap">{{callLog.notes}}</td>
						<td ng-cloak class="col-md-2"><span ng-show="{{callLog.callerFirstName!=null}}">{{callLog.callerFirstName}} {{callLog.callerLastName}}</span>
						<span ng-show="{{callLog.callerFirstName==null}}">{{callLog.callerAdminFirstName}} {{callLog.callerAdminLastName}}</span>
						</td>
						<td class="col-md-2">
							<span ng-show="{{isAdmin==2}}">
							<a ng-cloak type="submit"
								class="btn btn-xs btn-warning hint--top"
								data-hint="Edit Call Log"
								ng-click="editModal(callLog.callLogId,callLog.appointmentId)">&nbsp;<i
									class="glyphicon glyphicon-edit"></i>&nbsp;
							</a>
							</span>
							  <span ng-show="{{isAdmin==4}}">
							<a ng-show="{{callLog.isAllowToEdit==1}}" ng-cloak type="submit"
								class="btn btn-xs btn-warning hint--top"
								data-hint="Edit Call Log"
								ng-click="editModal(callLog.callLogId,callLog.appointmentId)">&nbsp;<i
									class="glyphicon glyphicon-edit"></i>&nbsp;
							</a>
							</span>
							<a ng-cloak ng-show="{{callLog.appointmentId!=null}}"
							class="btn btn-xs btn-primary hint--top"
							data-hint="View Appointment"
							ng-click="viewAppointments(callLog.appointmentId)"> &nbsp;<i
								class="glyphicon glyphicon-eye-open"></i> &nbsp;
						</a> 
					</td>
					</tr>
				</tbody>
				<tbody ng-show="!callLogs.length">
					<tr>
						<td colspan="5" align="center">No Records Found!</td>
					</tr>
				</tbody>
			</table>
			<dir-pagination-controls max-size="5" direction-links="true" boundary-links="true"> </dir-pagination-controls>
		</div>
		<!-- /.panel-body -->
	</div>
	<!-- /.col-lg-12 -->
</div>
</div>
<!-- Modal -->
<form id="myForm" name="myForm" novalidate ng-cloak>
	<div class="modal fade" id="calllogsModel" tabindex="-1" role="dialog"
		aria-labelledby="calllogsModelLabel">
		<div class="modal-dialog" role="d	ocument">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title" id="calllogsModelLabel">{{title}}</h4>
				</div>
				<div class="modal-body">

					<label>Date and Time</label>
					<div class="input-group">
						<input type="text" name="timeStamp" id="timeStamp"
							class="form-control" ng-model="calllogs.timeStamp"
							placeholder="Date and Time" required>
						<span class="input-group-addon white-color-bg"> <span
							class="glyphicon glyphicon-calendar"></span></span>
					</div>
					<span class="error-container"
						ng-show="myForm.timeStamp.$dirty && myForm.timeStamp.$invalid && !myForm.notes.$prestine">
						<span style="color: red"
						ng-show="myForm.timeStamp.$error.required" id="dateTimeError">Please
							Enter Date and Time</span>
					</span> <br /> <input type="hidden" id="patientId" class="form-control"
						ng-model="calllogs.patientId"> <input type="hidden"
						id="appointmentId" class="form-control"
						ng-model="calllogs.appointmentId"> <label>Response</label>
					<select class="form-control" ng-model="calllogs.response"
						name="response" id="response" ng-change="appointmentAlert()" required>
						<option value="">-- Select Response --</option>
						<option value="2">Not Interested/Injured</option>
						<option value="3">Voice Mail</option>
						<option value="4">Schedule Appointment</option>
						<option value="8">Call Back</option>
						<option value="9">Unable To Reach</option>
						<option value="5">Do Not Call</option>
					</select> <span class="error-container"
						ng-show="myForm.response.$dirty && myForm.response.$invalid && !myForm.notes.$prestine">
						<span style="color: red" ng-show="myForm.response.$error.required">Please
							Select Response</span>
					</span><br>
					<!-- Appointment Block -->
					<div class="well" ng-show="calllogs.response==4">
					<p>Please Provide Appointment Details</p>
					<label>Select Clinic</label> <select class="form-control"
						ng-change="getDoctors()" ng-model="calllogs.appointmentsForm.clinicId"
						name="clinicId" id="clinicId"
						ng-options="clinics.clinicId as clinics.clinicName for clinics in clinic"
						ng-required="calllogs.response==4">
						<option value="">-- Select Clinic --</option>
					</select> <span class="error-container"
						ng-show="myForms.clinicId.$dirty && myForms.clinicId.$invalid">
						<span style="color: red"
						ng-show="myForms.clinicId.$error.required">Please Select
							Clinic</span>
					</span> <br> <label>Select Doctor</label> <select
						class="form-control" ng-model="calllogs.appointmentsForm.doctorId"
						name="doctorId" id="doctorId"
						ng-options="doctors.id as doctors.doctorName for doctors in doctor">
						<option value="">-- Select Doctor --</option>
					</select><br> <label>Date & Time</label>
					<div class="input-group">
						<input type="text" name="scheduledDate" id="scheduledDate"
							class="form-control" ng-model="calllogs.appointmentsForm.scheduledDateTime"
							placeholder="Enter Date" ng-required="calllogs.response==4">
						<span class="input-group-addon white-color-bg"> <span
							class="glyphicon glyphicon-calendar"></span></span>
					</div>
					<span class="error-container"
						ng-show="myForms.scheduledDate.$dirty && myForms.scheduledDate.$invalid">
						<span style="color: red"
						ng-show="myForms.scheduledDate.$error.required">Please
							Enter Date</span>
					</span>
					</div>
					<!-- End Appointment Block -->
					
					
					
					 <label>Notes</label>
					<textarea name="notes" id="notes" class="form-control height-100"
						ng-model="calllogs.notes" placeholder="Notes" required
						maxlength="400"></textarea>
					<span class="error-container"
						ng-show="myForm.notes.$dirty && myForm.notes.$invalid && !myForm.notes.$prestine">
						<span style="color: red" ng-show="myForm.notes.$error.required"
						id="calllogsNotesError">Please Enter Notes</span>
					</span> <br />

				</div>
				<div class="modal-footer">
					<button class="btn btn-danger" data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-success" data-dismiss="modal"
						ng-class="{'button-disable':myForm.$invalid}"
						ng-disabled='myForm.$invalid' ng-show="options" ng-click="save()">Add</button>
					<button type="button" class="btn btn-success" data-dismiss="modal"
						ng-class="{'button-disable':myForm.$invalid || isClean()}"
						ng-disabled='isClean() || myForm.$invalid' ng-show='!options'
						ng-click="update()">Update</button>

				</div>
			</div>
		</div>
	</div>
</form>

<!--  View Appointments Modal-->

<div class="modal fade" id="viewAppointmentsModal" role="dialog">
	<div class="modal-dialog">

		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">View Appointment</h4>
			</div>
			<div class="modal-body">
				<table class="table table-striped table-bordered">
					<tbody ng-show="!appointments.notavailable">
						<tr>
							<td>Scheduled Date & Time</td>
							<td class="col-md-8">{{appointments.scheduledDateTime}}</td>
						</tr>
						<tr>
						<td>Clinic Name</td>
						<td class="col-md-8 wrap">{{appointments.clinicName}}</td>
						</tr>
					</tbody>
					<tbody ng-show="appointments.notavailable">
					<tr>
						<td colspan="5" align="center">No Appointment Added!</td>
					</tr>
				</tbody>

				</table>
				<div class="modal-footer">
					<button type="close" class="btn btn-danger" data-dismiss="modal">Close</button>


				</div>
			</div>
		</div>
	</div>

</div>


<!-- Call Logs View Patients -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
	aria-labelledby="myModalLabel">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content ">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">Patient Details</h4>
			</div>
			<div class="modal-body">
				<table class="table table-striped table-bordered">
					<tr>
						<td class="col-md-3"><b>Name</b></td>
						<td class="col-md-3">{{patient.name}}</td>
						<td class="col-md-3"><b>Gender</b></td>
						<td class="col-md-3">{{patient.gender}}</td>
						
					</tr>
					<tr>
						<td class="col-md-3"><b>Date Of Birth</b></td>
						<td class="col-md-3">{{patient.dateOfBirth}}</td>
						<td class="col-md-3"><b>Age</b></td>
						<td class="col-md-3">{{patient.age}}</td>
					</tr>
					<tr>
						<td class="col-md-3"><b>Phone Number</b></td>
						<td class="col-md-3">{{patient.phoneNumber}}</td>
						<td class="col-md-3"><b>Address</b></td>
						<td class="col-md-3">{{patient.address}}</td>
						
					</tr>
					<tr>
						<td class="col-md-3"><b>Unit Number</b></td>
						<td class="col-md-3">{{patient.unitNumber}}</td>
						<td class="col-md-3"><b>Number of Units</b></td>
						<td class="col-md-3">{{patient.numberOfUnits}}</td>
						
					</tr>
					<tr>
						<td class="col-md-3"><b>Units in Error</b></td>
						<td class="col-md-3">{{patient.unitInError}}</td>
						<td class="col-md-3"><b>Local Report Number</b></td>
						<td class="col-md-3">{{patient.localReportNumber}}</td>
						
						
					</tr>
					<tr>
						<td class="col-md-3"><b>Injuries</b></td>
						<td class="col-md-3">{{patient.injuries}}</td>
						<td class="col-md-3"><b>Crash Severity</b></td>
						<td class="col-md-3">{{patient.crashSeverity}}</td>
					</tr>
					<tr>
					
						<td class="col-md-3"><b>Crash Date</b></td>
						<td class="col-md-3">{{patient.crashDate}}</td>
							<td class="col-md-3"><b>Time of Crash</b></td>
						<td class="col-md-3">{{patient.timeOfCrash}}</td>
						
					</tr>
					<tr>
						<td class="col-md-3"><b>EMS Agency</b></td>
						<td class="col-md-3">{{patient.emsAgency}}</td>
						<td class="col-md-3"><b>Report Agency Name</b></td>
						<td class="col-md-3">{{patient.reportingAgencyName}}</td>
					</tr>
					
					<tr>
						<td class="col-md-3"><b>County</b></td>
						<td class="col-md-3">{{patient.county}}</td>
						<td class="col-md-3"><b>City Village Township</b></td>
						<td class="col-md-3">{{patient.cityVillageTownship}}</td>
					</tr>
					<tr>
					<td class="col-md-3"><b>Medical Facility</b></td>
						<td class="col-md-3">{{patient.medicalFacility}}</td>
						<td colspan="2"></td>
					</tr>
					<tr>
						<td class="col-md-3"><b>At Fault INS. Company</b></td>
						<td class="col-md-3">{{patient.atFaultInsuranceCompany}}</td>
						<td class="col-md-3"><b>At Fault Policy Number</b></td>
						<td class="col-md-3">{{patient.atFaultPolicyNumber}}</td>
					</tr>
					<tr>
						<td class="col-md-3"><b>Victim INS. Company</b></td>
						<td class="col-md-3">{{patient.victimInsuranceCompany}}</td>
						<td class="col-md-3"><b>Victim Policy Number</b></td>
						<td class="col-md-3">{{patient.victimPolicyNumber}}</td>
					</tr>
				</table>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>


<script>
 $(function(){
 	$("html,body").scrollTop(0);
 });

$('#timeStamp').datetimepicker({
			pickTime : true,
			format:'MM/DD/YYYY hh:mm A',
			maxDate : new Date()
		});
$('#timeStamp').keydown(function(e){
	 e.preventDefault();
	});
$('#timeStamp').bind("cut copy paste",function(e) {
   e.preventDefault();
});		
		
		
$('#scheduledDate').datetimepicker({
	pickTime : true,
	format:'MM/DD/YYYY hh:mm A',
	minDate : new Date()
});

$('#scheduledDate').keydown(function(e){
	 e.preventDefault();
	});
$('#scheduledDate').bind("cut copy paste",function(e) {
    e.preventDefault();
});
</script>
