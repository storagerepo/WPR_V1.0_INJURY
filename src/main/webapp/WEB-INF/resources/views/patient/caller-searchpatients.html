<link rel="stylesheet"
	href="resources/components/datetime/datetimepicker.css"></link>
<script src="resources/components/datetime/datetimepicker.js"></script>
<script src="resources/components/datetime/moment.js"></script>
<div  ng-cloak>
<div class="row">
<div class="col-lg-12">
		
	 <div flash-message="2000" class="col-md-5 pull-right margin-top35"></div>
	 <h2 class="page-header">Search Patients</h2>
	</div>
	<!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">
 <form name="patientSearchForm" novalidate ng-cloak> 
 	<div class="col-md-12 no-padding">
		<div class="col-md-5ths">
			<label>County</label>
			<select class="form-control input-sm" ng-model="patient.countyId">
          		<option value="0" ng-selected="true">All</option>
          		<option ng-repeat="county in mycounties" value="{{county.countyId}}" ng-selected="{{county.countyName === patient.county}}">{{county.countyName}}</option>
     		</select>
        </div>
        <div class="col-md-5ths">
       		<label>Crash From Date</label>
			<div class="input-group">
				<input type="text" name="crashFromDate" id="CrashFromDate" class="form-control input-sm" ng-model="patient.crashFromDate" ng-change="checkCustomDate(patient.numberOfDays)" placeholder="Crash From Date" > 
				<span class="input-group-addon white-color-bg"> <span class="glyphicon glyphicon-calendar"></span></span>
			</div>
        </div>
        <div class="col-md-5ths">
       		<label>Number of Days</label>
			<select class="form-control input-sm"  ng-model="patient.numberOfDays" name="numberOfDays" ng-change="checkCustomDate(patient.numberOfDays)">
            	<option value="1" ng-selected="true">1</option>
            	<option value="7">7</option>
            	<option value="15">15</option>
            	<option value="30">30</option>
            	<option value="0">Custom</option>
            </select>
       	</div>
        <div class="col-md-5ths">
       		<label>Crash To Date</label>
	       	<div class="input-group">
				<input type="text" name="crashToDate" id="CrashToDate" ng-change="crashToRequired=false" class="form-control input-sm" ng-model="patient.crashToDate" placeholder="Crash To Date"  ng-disabled="disableCustom"> 
				<span class="input-group-addon white-color-bg"> <span class="glyphicon glyphicon-calendar"></span></span>
         	</div>
         	<span style="color:red" ng-if="crashToRequired==true">Please Enter Crash To Date</span>
        </div>
        <div class="col-md-5ths">
			<label>Tier</label>
			<select class="form-control input-sm"  ng-model="patient.tier" name="tier">
            	<option value="0" ng-selected="true">All</option>
            	<option value="1">Tier1</option>
            	<option value="2">Tier2</option>
            	<option value="3">Tier3</option>
            </select>
       	</div>
    </div>

	<div class="col-md-12"> <br/>  </div>           
          
    <div class="col-md-12 no-padding">
    	<div class="col-md-5ths">
       		<label>Added On From Date</label>
	       	<div class="input-group">
				<input type="text" name="addedOnFromDate" id="AddedFromDate" ng-change="isSelectedAddedFromDate=false"class="form-control input-sm" ng-model="patient.addedOnFromDate" placeholder="Added On From Date" > 
				<span class="input-group-addon white-color-bg"> <span class="glyphicon glyphicon-calendar"></span></span>
			</div>
        </div>
		<div class="col-md-5ths">
       		<label>Added On To Date</label>
       		<div class="input-group">
				<input type="text" name="addedOnToDate" id="AddedToDate" ng-change="addedToRequired=false" class="form-control input-sm" ng-model="patient.addedOnToDate" placeholder="Added On To Date" ng-disabled="isSelectedAddedFromDate"> 
				<span class="input-group-addon white-color-bg"> <span class="glyphicon glyphicon-calendar"></span></span>
       		</div>
       		<span style="color:red" ng-if="addedToRequired==true">Please Enter Added On To Date</span>
       	</div>
       	<div class="col-md-5ths">
       		<label>&nbsp;</label><br/>
        	<a class="btn btn-success btn-sm" ng-class="{'button-disable':patientSearchForm.$invalid}"  ng-disabled='patientSearchForm.$invalid' ng-click="searchPatients()">Search</a>
        	<a class="btn btn-danger btn-sm" ng-click="resetSearchData()">Reset</a>
       	</div>
     </div>
     <div class="col-md-12">
			<div class="col-md-12 no-padding hr-tag-alter"></div>
				<div  class="col-md-6 no-padding">
					<a href="" ng-disabled="isCleanCheckbox()" ng-click="releasePatientMultiConfirmPopup()" class="btn btn-sm btn-danger">Release Patients</a>
					<a href="" ng-disabled="isCleanCheckbox()||patient.isArchived==1" ng-click="moveArchive()" class="btn btn-sm btn-warning">Move to Archive</a>
					<a href="" ng-disabled="isCleanCheckbox()||patient.isArchived==0" ng-click="releaseArchive()" class="btn btn-sm btn-primary">Release from Archive</a>
				</div>
				<div class="col-md-6 no-padding">
					<div class="col-md-3 margin-top-5 text-right no-padding">Records Type&nbsp;&nbsp;</div>
					<div class="col-md-3 no-padding">
						<select class="form-control input-sm" ng-change="secoundarySearchPatient()" name="isArchived" ng-model="patient.isArchived">
				          	<option value="0" ng-selected="true">Open</option>
				          	<option value="1">Archived</option>
				     	</select>
					</div>
					<div class="col-md-3 margin-top-5 text-right no-padding">Filter Status by &nbsp;&nbsp; </div>
					<div class="col-md-3 no-padding">
						<select class="form-control input-sm" ng-change="secoundarySearchPatient()" name="isArchived" ng-model="patient.patientStatus">
							<option value="6" ng-selected="true">All</option>
				          	<option value="0">New</option>
				          	<option value="1">Active</option>
				          	<option value="2">Not Interested/Injured</option>
				          	<option value="3">Voice Mail</option>
				          	<option value="4">Schedule Appointment</option>
				          	<option value="5">Do Not Call</option>
				     	</select>
					</div>
				</div>
				<div class="col-md-12 no-padding hr-tag-alter"></div>
		</div>              
</form>                    
                   <div class="col-md-12"> 
                    
                    
                    
                    <table class="table table-striped table-bordered" ng-cloak>
                        <thead>
                            <tr>
                            	<th width="2%"><input ng-change="isChecked()" ng-model="isCheckedAllPatients" type="checkbox" id="checkAll"></th>
                                <th width="18%">Patient Name</th>
                                <th width="18%">Local Report Number</th>
                                <th width="15%">Phone Number</th>
                                <th width="10%">Crash Date</th>
                                <th width="8%">County</th>
                                <th width="6%">Tier</th>
                                <th width="9%">Added On</th>
                                <th width="4%">Status</th>
                                <th width="10%">Action</th>
                            </tr>
                            <tr>
                            	<th></th>
								<th>
								<div class="input-group">
  								<span class="input-group-addon search" id="basic-addon2"><i class="fa fa-search"></i></span>
								<input class="form-control" type="text"
									ng-model="patient.patientName" ng-change="secoundarySearchPatient()" placeholder="Patient Name"></div>
								</th>
								<th>
								<div class="input-group">
  								<span class="input-group-addon search" id="basic-addon2"><i class="fa fa-search"></i></span>
								<input class="form-control" type="text"
									ng-model="patient.localReportNumber" ng-change="secoundarySearchPatient()" placeholder="Report No"></div></th>
								
								<th>
								<div class="input-group">
  								<span class="input-group-addon search" id="basic-addon3"><i class="fa fa-search"></i></span>
								<input class="form-control" type="text"
									ng-model="patient.phoneNumber" ng-change="secoundarySearchPatient()" placeholder="Phone No"></div></th>
								<th></th>
								<th></th>
								<th></th>	
								<th></th>
								<th></th>
								<th></th>								
							</tr>
                        </thead>
                        <tbody>
                            <tr ng-show="callerPatientSearchData.length>0"  dir-paginate="callerData in callerPatientSearchData|itemsPerPage:patient.itemsPerPage" current-page="setPage" total-items="totalRecords">
                                <td><input ng-change="isCheckedIndividual()" ng-model="callerData.selected" ng-checked="callerData.selected" type="checkbox"></td>
                                <td>{{callerData.name}}</td>
                                <td>{{callerData.localReportNumber}}</td>
                                <td>{{callerData.phoneNumber}}</td>
                               	<td>{{callerData.crashDate}}</td>
                                <td>{{callerData.county}}</td>
                                <td>{{callerData.tier}}</td>
                                <td>{{callerData.addedDate}}</td>
                                <td>{{callerData.patientStatusName}}</td>
                                <td>
                                	<a href="{{callerData.crashReportFileName}}" ng-cloak target="_blank" class="btn btn-xs btn-warning hint--top" data-hint="View Crash Report"><i
								class="fa fa-file-pdf-o"></i></a>
								<a href="" ng-cloak ng-click="releasePatientSingleConfirmPopup(callerData.patientId)" class="btn btn-xs btn-danger hint--top" data-hint="Release Patient"><i class="fa fa-external-link-square"></i></a>
								<a href="#/dashboard/Calllogs/{{callerData.patientId}}" ng-cloak class="btn btn-xs btn-primary hint--top" data-hint="View Call Logs"><i
								class="fa fa-eye"></i></a>&nbsp;
								</td>
                            </tr>
                            <tr ng-show="callerPatientSearchData.length==0">
                            <td colspan="10"><center><strong>No Records Found!!!</strong></center></td>
                            </tr>
                        </tbody>
                    </table>
                    <dir-pagination-controls max-size="5" on-page-change="searchPatientsFromPage(newPageNumber)" direction-links="true" boundary-links="true" >
    					</dir-pagination-controls> 
    					</div>
<div class="col-md-3 pull-right">
<label>Number of Records</label>
	<select
		class="form-control input-sm" ng-model="patient.itemsPerPage" name="itemsPerPage"
		id="itemsPerPage">
		<option value="10">Show 10 Per Page</option>
		<option value="25">Show 25 Per Page</option>
		<option value="50">Show 50 Per Page</option>
		<option value="100">Show 100 Per Page</option>
	</select> 
</div>  
</div>  	

<div class="modal fade" id="confirmModal" role="dialog">
    <div class="modal-dialog">    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Confirmation </h4>
        </div>
        <div class="modal-body">
        	<div ng-show="isSingle">Are you sure want to release this patient?</div>
        	<div ng-hide="isSingle">Are you sure want to release these selected patients?</div>
        </div>
        <div class="modal-footer" >
         <button type="close" class="btn btn-danger" data-dismiss="modal">Cancel</button>
             <a href="" type="submit" ng-show="isSingle" class="btn btn-success"  data-dismiss="modal" ng-disabled='myForm.$invalid' ng-click="releaseSinglePatient(releasePatientId)">Release</a>
             <a href="" type="submit" ng-hide="isSingle" class="btn btn-success"  data-dismiss="modal" ng-disabled='myForm.$invalid' ng-click="releaseMultiPatient()">Release</a>
        </div>
      </div>
      
    </div>
 </div>
 				
<script>
$(function(){
	$("html,body").scrollTop(0);
});
    					
$('#CrashFromDate').datetimepicker({
	pickTime : false,
	format:'MM/DD/YYYY',
	maxDate : new Date()
}).on('dp.change', function (selected) {
    var minimumDate = new Date(selected.date.valueOf());
    $('#CrashToDate').data("DateTimePicker").setMinDate(minimumDate);
});

$('#CrashToDate').datetimepicker({
	pickTime : false,
	format:'MM/DD/YYYY',
	maxDate : new Date()
});  

$('#AddedFromDate').datetimepicker({
	pickTime : false,
	format:'MM/DD/YYYY',
	maxDate : new Date()
}).on('dp.change', function (selected) {
    var minimumDate = new Date(selected.date.valueOf());
    $('#AddedToDate').data("DateTimePicker").setMinDate(minimumDate);
});

$('#AddedToDate').datetimepicker({
	pickTime : false,
	format:'MM/DD/YYYY',
	maxDate : new Date()
});

</script>