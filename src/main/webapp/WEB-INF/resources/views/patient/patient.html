<div>
<div class="row">

	<div class="col-lg-12">
	<a ui-sref="dashboard.Crashreport" class="btn-sm btn-primary pull-right margin-top-40 btn-margin-left" style="text-decoration: none;" ng-show="{{isAdmin==1}}"><i class="fa fa-upload fa-lg"></i> Upload Crash Report PDF</a>
	<a ui-sref="dashboard.add-patient" class="btn-sm btn-primary pull-right margin-top-40 margin-left-5 btn-margin-left" ng-show="{{isAdmin==1}}"><i class="fa fa-plus-circle fa-lg"></i> Add Patient</a>
		<h2 class="page-header">Patients</h2>
	</div>
	<!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">

	<div class="col-md-12">
<div class="col-md-4" ng-hide="{{isAdmin==4}}">
                           <label>Patient Status:</label><select ng-change="patientStatus()" style="width: 225px;" class="form-control" ng-model="Status" name="patientStatus" id="patientStatus" required>
  							  	<option value="">All</option>
  								<option value="1">Active</option>
                                <option value="2">Appointment Scheduled</option>
								<option value="3">Do-Not-Call</option>                                                   
</select></div>
<div flash-message="2000" class="col-md-4"></div>
 <div class="col-md-4 pull-right">
                          <label>Number of Records</label> <select class="form-control" ng-model="noOfRows" name="noOfRows" id="noOfRows">
  							  	<option value="10">Show 10 Per Page</option>
  								<option value="25">Show 25 Per Page</option>
                                <option value="50">Show 50 Per Page</option>
								<option value="100">Show 100 Per Page</option>
								<option value="{{patientss.length}}">Show All</option>                                                    
</select></div>
		<!-- /.panel-heading -->
 		<table class="table table-hover">
				<thead>
					<tr>
						<th style="width:100px!important;" ng-mousedown="sort('name')">Name <span class="glyphicon sort-icon" ng-show="sortKey=='name'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
					 <th style="width:80px!important;" ng-mousedown="sort('phoneNumber')">Phone Number&nbsp;<span class="glyphicon sort-icon" ng-show="sortKey=='phoneNumber'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
						 <th style="width:80px!important;"ng-mousedown="sort('localReportNumber')">Local Report Number&nbsp;<span class="glyphicon sort-icon" ng-show="sortKey=='localReportNumber'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
					  <th style="width:80px!important;" ng-mousedown="sort('address')" ng-show="{{isAdmin==4}}">Address&nbsp;<span class="glyphicon sort-icon" ng-show="sortKey=='address'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
					 <th style="width:80px!important;" ng-mousedown="sort('country')" ng-show="{{isAdmin==4}}">County&nbsp;<span class="glyphicon sort-icon" ng-show="sortKey=='country'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
					  <th style="width:80px!important;" ng-mousedown="sort('callerName')" ng-hide="{{isAdmin==4}}">Caller Name&nbsp;<span class="glyphicon sort-icon" ng-show="sortKey=='callerName'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
					 <th style="width:80px!important;" ng-mousedown="sort('patientStatus')" ng-hide="{{isAdmin==4}}">Status&nbsp;<span class="glyphicon sort-icon" ng-show="sortKey=='patientStatus'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
						
						<th style="width:120px!important;">Actions</th>
						
						
					</tr>
						
						<tr>
						<th ><input type="text" class="form-control" ng-model="search.name" placeholder="Search by Name"/></th>
						<th><input type="text" class="form-control" ng-model="search.phoneNumber" placeholder="Search by Phone Number"/></th>
						<th><input type="text" class="form-control" ng-model="search.localReportNumber" placeholder="Search by Local Report Number"/></th>
						<th ng-show="{{isAdmin==4}}"><input type="text" class="form-control" ng-model="search.address" placeholder="Search by Address"/></th>
						<th ng-show="{{isAdmin==4}}"><input type="text" class="form-control" ng-model="search.country" placeholder="Search by County"/></th>
						<th ng-hide="{{isAdmin==4}}"><input type="text" class="form-control" ng-model="search.callerName" placeholder="Search by Caller Name"/></th>
						<th ng-hide="{{isAdmin==4}}"><input type="text" class="form-control" ng-model="search.patientStatus" placeholder="Search by Status"/></th>
						
						<th></th>
					</tr>
				</thead>
				
				<tbody ng-show="patientss.length>0" dir-paginate="patients in patientss | filter:search | orderBy:sortKey:reverse|itemsPerPage:noOfRows">
					<tr>
						
						<td ng-show="{{isAdmin==4}}">{{patients.name}}</td>
						<td ng-hide="{{isAdmin==4}}"><a href="#/dashboard/Calllogs/{{patients.id}}" ng-cloak>{{patients.name}}</a></td>
						<td ng-cloak>{{patients.phoneNumber==""?'N/A':patients.phoneNumber}}</td>
						<td ng-cloak>{{patients.localReportNumber}}</td>
						<td ng-cloak ng-show="{{isAdmin==4}}">{{patients.address}}</td>
						<td ng-cloak ng-show="{{isAdmin==4}}">{{patients.country}}</td>
						<td ng-cloak ng-hide="{{isAdmin==4}}">{{patients.callerName}}</td>
						<td ng-cloak ng-hide="{{isAdmin==4}}">{{patients.patientStatus}}</td>
						<td>
						<span>
						<a href="#/dashboard/Calllogs/{{patients.id}}" ng-cloak class="btn btn-xs btn-primary hint--top" data-hint="View Call Logs" ng-hide="{{isAdmin==4}}"><i
								class="glyphicon glyphicon-eye-open"></i>
						</a>
						<a href="" ng-cloak class="btn btn-xs btn-primary hint--top" ng-click="viewPatientModal(patients.id)" ng-show="{{isAdmin==4}}" data-hint="View Patient Details"><i
								class="glyphicon glyphicon-eye-open"></i>
						</a>
						
						<span ng-hide="{{patients.patientStatus}}==Do-Not-Call">
						 <a href="#/dashboard/EditPatient/{{patients.id}}"  ng-cloak class="btn btn-xs btn-warning hint--top" data-hint="Edit Patient" ng-show="{{isAdmin==1}}"><i
								class="glyphicon glyphicon-edit"></i>
						</a>
						<a href="" ng-cloak ng-click="deletePatient(patients.id)" class="btn btn-xs btn-danger hint--top" data-hint="Delete Patient" ng-show="{{isAdmin==1}}"><i
								class="glyphicon glyphicon-trash"></i>
						</a>
						<span ng-show="{{isAdmin==1}}">
						<a ng-hide="{{patients.callerId}}==''" href="" ng-cloak ng-click="assignCaller(patients.id,patients.callerId)" class="btn btn-xs btn-success hint--top" data-hint="Change Caller"><i
								class="glyphicon glyphicon-saved"></i>
						</a>
						<a ng-hide="{{patients.callerId}}!=''" href="" ng-cloak ng-click="assignCaller(patients.id,patients.callerId)" class="btn btn-xs btn-danger hint--top" data-hint="Assign Caller"><i
								class="glyphicon glyphicon-saved"></i>
						</a>
						</span>
						<span ng-hide="{{isAdmin==1 || isAdmin==4}}">
						<a title="doctor" ng-hide="{{patients.doctorId}}==''" href="" ng-cloak ng-click="assignDoctor(patients.id,patients.doctorId)" data-hint="Change Doctor" class="btn btn-xs btn-success hint--top"><i
								class="fa fa-user-md "></i>	</a>
						<a title="doctor" ng-hide="{{patients.doctorId}}!=''" href="" ng-cloak ng-click="assignDoctor(patients.id,patients.doctorId)" data-hint="Assign Doctor" class="btn btn-xs btn-danger hint--top"><i
								class="fa fa-user-md "></i>
						</a>
						</span>
						<a target="_blank" class="btn btn-xs btn-info hint--lefter"  data-hint="View Crash Report" href="/Injury/Report/{{patients.crashReportFileName}}" ng-cloak ng-hide="{{isAdmin==4}}"><i
								class="fa fa-file-pdf-o"></i></a>
						</span>
						 
					</span>	
						</td>
					</tr>
				</tbody>
				
				<tbody ng-show="patientss.length==0">
				<tr>
				<td colspan="5" align="center">No Record Found</td>
				</tr>
				</tbody>
			</table>
			<dir-pagination-controls max-size="5" direction-links="true"
					boundary-links="true"> </dir-pagination-controls>
		<!-- /.panel-body -->
	</div>
	<!-- /.col-lg-12 -->
</div>

<!--  Delete Patient Modal -->
<div class="modal fade" id="deletePatientModal" role="dialog">
    <div class="modal-dialog">    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Confirmation</h4>
        </div>
        <div class="modal-body">Are you sure to delete patient?
              
        </div>
        <div class="modal-footer" >
         <button type="close" class="btn btn-danger" data-dismiss="modal">No</button>
             <a type="submit" class="btn btn-success"  data-dismiss="modal" ng-click="deleteOnePatient()">Yes</a>
        </div>
      </div>
      
    </div>
 </div>

<!--  Assign Modal -->
<div class="modal fade" id="assignCallerModel" role="dialog">
    <div class="modal-dialog">    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Assign Caller - Patient - {{assignPatientId}}</h4>
        </div>
        <form name="assignForm">
        <div class="modal-body">
             
              <label>Select the Caller</label>
                          <div class="col-md-12 input-group">
                           <select class="form-control" ng-model="patients.callerId" name="callerId" id="callerId" ng-change="changeCaller()" ng-options="staff.id as staff.firstName for staff in staffs" required>
  							  <option value="">-- Select Caller --</option>
						  </select> 
						  <span
									class="error-container"
									ng-show="assignForm.callerId.$dirty && assignForm.callerId.$invalid">
									<span ng-cloak style="color: red"
									ng-show="assignForm.callerId.$error.required">Please Select Caller</span>
								</span>  
                           </div>
        </div>
        <div class="modal-footer">
         <button type="close" class="btn btn-danger" data-dismiss="modal">Close</button>
             <a type="submit" class="btn btn-success" ng-disabled='assignForm.$invalid' ng-class="{'button-disable':assignForm.$invalid}"  ng-click="updateCaller()">Assign</a>
        </div>
        </form>
      </div>
      
    </div>
 </div>
<!-- End Assign Model -->

<!--  Doctor Assign Modal -->

 <form id="myForms" name="myForms" novalidate>
<div class="modal fade" id="assignDoctorModel" role="dialog">
    <div class="modal-dialog">    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Assign Doctor - Patient - {{assignPatientId}}</h4>
        </div>
        <div class="modal-body">
              <label>Select Clinic:</label>
             
		                           <select class="form-control" ng-change="doctorName()" ng-model="patients.clinicId" name="clinicId" id="clinicId" ng-options="clinics.clinicId as clinics.clinicName for clinics in clinic" required>
		  							  <option value="">-- Select Clinic --</option>
		                             </select> 
		                             
                             <span class="error-container" ng-show="myForms.clinicId.$dirty && myForms.clinicId.$invalid">
                                <span style="color:red" ng-show="myForms.clinicId.$error.required">Please Select the Clinic</span>
                              </span>
		                             <br>
              <label>Select the Doctor</label>
                          <div class="col-md-12 input-group">
                           <select class="form-control" ng-model="patients.doctorId" name="doctorId" id="doctorId" ng-options="doctors.id as doctors.doctorName for doctors in doctor" required>
  							  <option value="">-- Select Doctor --</option>
						  </select>  
						  <span class="error-container" ng-show="myForms.doctorId.$dirty && myForms.doctorId.$invalid">
                                <span style="color:red" ng-show="myForms.doctorId.$error.required">Please Select the Doctor</span>
                              </span> 
                           </div>
        </div>
        <div class="modal-footer">
         <button type="close" class="btn btn-danger" data-dismiss="modal">Close</button>
             <a type="submit" class="btn btn-success"  ng-disabled='myForms.$invalid' ng-class="{'button-disable':myForms.$invalid}" ng-click="updateDoctor()">Assign</a>
        </div>
      </div>
      
    </div>
 </div>
 </form>
<!-- End Assign Model -->

<!-- Start of Patient Details Modal -->

 <div class="modal fade" id="viewPatientModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content ">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Patient Details</h4>
      </div>
      <div class="modal-body">
	<table class="table table-striped table-bordered">
					<tr>
						<td class="col-md-3"><b>Name</b></td>
						<td class="col-md-3">{{patients.name}}</td>
						<td class="col-md-3"><b>Time of Crash</b></td>
						<td class="col-md-3">{{patients.timeOfCrash}}</td>
						</tr>
						<tr>
						<td class="col-md-3"><b>Date Of Birth</b></td>
						<td class="col-md-3">{{patients.dateOfBirth}}</td>
						<td class="col-md-3"><b>Gender</b></td>
						<td class="col-md-3">{{patients.gender}}</td>
						</tr>
						<tr>
						<td class="col-md-3"><b>Phone Number</b></td>
						<td class="col-md-3">{{patients.phoneNumber}}</td>
						<td class="col-md-3"><b>Injuries</b></td>
						<td class="col-md-8">{{patients.injuries}}</td>
						</tr>
						<tr>
						<td class="col-md-3"><b>Address</b></td>
						<td class="col-md-3">{{patients.address}}</td>
						<td class="col-md-3"><b>EMS Agency</b></td>
						<td class="col-md-3">{{patients.emsAgency}}</td>
						</tr>
						<tr>
						<td class="col-md-3"><b>Local Report Number</b></td>
						<td class="col-md-3">{{patients.localReportNumber}}</td>
						<td class="col-md-3"><b>Medical Facility</b></td>
						<td class="col-md-3">{{patients.medicalFacility}}</td>
						</tr>
						<tr>
						<td class="col-md-3"><b>Crash Severity</b></td>
						<td class="col-md-3">{{patients.crashSeverity}}</td>
						<td class="col-md-3"><b>Report Agency Name</b></td>
						<td class="col-md-3">{{patients.reportingAgencyName}}</td>
						</tr>
						<tr>
						<td class="col-md-3"><b>Number of Units</b></td>
						<td class="col-md-3">{{patients.numberOfUnits}}</td>
						<td class="col-md-3"><b>Units in Error</b></td>
						<td class="col-md-3">{{patients.unitInError}}</td>
						</tr>
						<tr>
						<td class="col-md-3"><b>County</b></td>
						<td class="col-md-3">{{patients.country}}</td>
						<td class="col-md-3"><b>City Village Township</b></td>
						<td class="col-md-3">{{patients.cityVillageTownship}}</td>
						</tr>
						<tr>
						<td class="col-md-3"><b>Crash Date</b></td>
						<td class="col-md-3">{{patients.crashDate}}</td>
						<td class="col-md-3"><b>Unit Number</b></td>
						<td class="col-md-3">{{patients.unitNumber}}</td>
						</tr>
						
	 				</table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
         </div>
    </div>
  </div>
</div>

<!-- End of Patient Details Modal -->


  <!-- Add/Edit Model -->
<!-- <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog">
    <div class="modal-content" nv-file-drop="" uploader="uploader" filters="queueLimit, customFilter">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="close()"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Add Patient - Upload Crash Report PDF</h4>
      </div>
      <div class="modal-body" >

      <div class="btn btn-primary btn-file" >
       Browse .PDF Crash Report Files to Upload
                    <input class="btn btn-primary" type="file" nv-file-select="image/*" uploader="uploader" name="file" id="file" multiple/>
                   </div>&nbsp;&nbsp;<span ng-cloak style="color:red" id="fileUploadError">Please Select Only PDF Files</span><br/><br/>
             <div id="uploadSuccessAlert" class="panel well" style="color:green;font-weight:bold;">
            <span id="uploadSuccessStatus"></span>
                        </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th width="50%" >Name</th>
                                <th ng-show="uploader.isHTML5" >Size</th>
                                <th ng-show="uploader.isHTML5" >Progress</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr  ng-hide="uploader.queue.length==0" ng-repeat="item in uploader.queue" >
                                <td><strong >{{ item.file.name }}</strong></td>
                                <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024/1024|number:3 }} MB</td>
                                <td ng-show="uploader.isHTML5">
                                    <div class="progress" style="margin-bottom: 0;">
                                        <div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
                                 </div>
                                </td>
                                <td class="text-center">
                                    <span ng-show="uploader.queue[0].isSuccess"><i class="glyphicon glyphicon-ok"></i></span>
                                    <span ng-show="uploader.queue[0].isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span>
                                    <span ng-show="uploader.queue[0].isError"><i class="glyphicon glyphicon-remove"></i></span>
                                </td>
                                <td><button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()">
                                        <span class="glyphicon glyphicon-trash"></span> Remove
                                    </button></td>
                               
                            </tr>
                            <tr ng-show="uploader.queue.length==0">
                            <td colspan="5"><center><strong>No files added!</strong></center></td>
                            </tr>
                        </tbody>
                        <span id="error_msg" class="error-text" ng-show="!uploader.getNotUploadedItems().length"></span>
                    </table>
      </div>
      <div class="modal-footer">
      				<button type="button" class="btn btn-success" ng-click="uploader.queue[0].upload()" ng-class="{'button-disable':!uploader.getNotUploadedItems().length}" ng-disabled="!uploader.getNotUploadedItems().length">
                    <span class="glyphicon glyphicon-upload"></span> Upload
                    </button>
                    <button type="button" class="btn btn-warning" ng-click="uploader.queue[0].cancel()"  ng-class="{'button-disable':!uploader.queue[0].isUploading}" ng-disabled="!uploader.queue[0].isUploading" >
                    <span class="glyphicon glyphicon-ban-circle"></span> Cancel
                    </button>
                    <button type="button" class="btn btn-danger" ng-click="close()" data-dismiss="modal" >
                    <span class="glyphicon glyphicon-ban-circle"></span> Close
                    </button>
                    
      </div>
    <div class="modal-footer">  
      <button type="button" class="btn btn-success btn-s" ng-click="uploader.uploadAll()" ng-disabled="!uploader.getNotUploadedItems().length">
                            <span class="glyphicon glyphicon-upload"></span> Upload all
                        </button>
                        <button type="button" class="btn btn-warning btn-s" ng-click="uploader.cancelAll()" ng-disabled="!uploader.isUploading">
                            <span class="glyphicon glyphicon-ban-circle"></span> Cancel all
                        </button>
                        <button type="button" class="btn btn-danger btn-s" ng-click="uploader.clearQueue()" ng-disabled="!uploader.queue.length">
                            <span class="glyphicon glyphicon-trash"></span> Remove all
                        </button>
                        <button type="button" class="btn btn-danger btn-s" data-dismiss="modal" aria-label="Close" ng-click="close()">
                            <span class="glyphicon glyphicon-trash"></span> Close
                        </button>
    </div>
    </div>
    </div>/.modal-content
  </div> --><!-- /.modal-dialog -->
<!-- /.modal -->
</div>
<script>
$(function(){
	$("html,body").scrollTop(0);
});
/* $("#file").change(function(e) {
	var ext = $("input#file").val().split(".").pop().toLowerCase();
	

	if($.inArray(ext, ["csv"]) == -1) {
	
		document.getElementById('error_msg').innerHTML = "Invalid file!";

		var file=invalid;
	return false;
	}
	else{
		document.getElementById('error_msg').innerHTML = "";
	}
	    
		return false;

	});
 */

</script>

